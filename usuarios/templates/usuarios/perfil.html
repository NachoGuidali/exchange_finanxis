{% extends "base.html" %}
{% block title %}Perfil — Finanxis{% endblock %}
{% block meta_description %}Datos personales y estado de tu cuenta en Finanxis.{% endblock %}

{% block content %}
<section class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8 space-y-6">

  <!-- Header -->
  <header class="rounded-2xl border border-gray-200 bg-white p-5 flex items-start justify-between gap-4">
    <div>
      <h1 class="text-2xl sm:text-3xl font-extrabold text-gray-900">Tu perfil</h1>
      <p class="text-gray-600">Revisá tus datos principales y el estado de verificación.</p>
    </div>
    <div class="flex gap-2">
      <a href="{% url 'configuracion' %}?tab=perfil" class="rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm hover:bg-gray-50">Editar</a>
      <a href="{% url 'configuracion' %}?tab=seguridad" class="rounded-xl bg-primary text-dark font-semibold px-4 py-2 text-sm shadow-soft hover:opacity-90">Seguridad</a>
    </div>
  </header>

  <!-- Datos personales -->
  <section class="rounded-2xl border border-gray-200 bg-white p-5">
    <h2 class="text-lg font-semibold text-gray-900">Datos personales</h2>
    <dl class="mt-4 grid gap-4 sm:grid-cols-2">
      <div>
        <dt class="text-xs text-gray-500">Nombre</dt>
        <dd class="text-gray-900 font-medium">{{ request.user.first_name|default:request.user.nombre|default:"—" }} {{ request.user.last_name|default:"" }}</dd>
      </div>
      <div>
        <dt class="text-xs text-gray-500">Usuario</dt>
        <dd class="text-gray-900 font-medium">{{ request.user.username }}</dd>
      </div>
      <div>
        <dt class="text-xs text-gray-500">Email</dt>
        <dd class="text-gray-900 font-medium">{{ request.user.email }}</dd>
      </div>
      <div>
        <dt class="text-xs text-gray-500">Teléfono</dt>
        <dd class="text-gray-900 font-medium">{{ request.user.telefono|default:"—" }}</dd>
      </div>
      <div>
        <dt class="text-xs text-gray-500">Documento</dt>
        <dd class="text-gray-900 font-medium">{{ request.user.doc_tipo|default:"—" }} {{ request.user.doc_nro|default:"" }}</dd>
      </div>
      <div>
        <dt class="text-xs text-gray-500">Domicilio</dt>
        <dd class="text-gray-900 font-medium">{{ request.user.domicilio|default:"—" }}</dd>
      </div>
    </dl>
  </section>

  <!-- Estado de cuenta -->
  <section class="rounded-2xl border border-gray-200 bg-white p-5">
    <h2 class="text-lg font-semibold text-gray-900">Estado de la cuenta</h2>
    <div class="mt-4 grid gap-4 sm:grid-cols-3">
      <div class="rounded-xl border border-gray-200 bg-gray-50 p-4">
        <p class="text-xs text-gray-500">Verificación</p>
        <p class="mt-1 font-semibold">
          {% if request.user.estado_verificacion == 'aprobado' %}
            ✅ Aprobada
          {% elif request.user.estado_verificacion == 'rechazado' %}
            ❌ Rechazada
          {% else %}
            ⏳ Pendiente
          {% endif %}
        </p>
      </div>
      <div class="rounded-xl border border-gray-200 bg-gray-50 p-4">
        <p class="text-xs text-gray-500">2FA</p>
        <p class="mt-1 font-semibold">
          {% if request.user.has_2fa %}✅ Activo{% else %}⚠️ Desactivado{% endif %}
        </p>
      </div>
      <div class="rounded-xl border border-gray-200 bg-gray-50 p-4">
        <p class="text-xs text-gray-500">Preferencia de tema</p>
        <p class="mt-1 font-semibold"><span id="pref-theme-label">Auto</span></p>
      </div>
    </div>
    <div class="mt-4">
      <a href="{% url 'configuracion' %}" class="text-primary text-sm underline">Configurar preferencias</a>
    </div>
  </section>
</section>

<script>
  // reflejar preferencia de tema guardada (si existe)
  (function(){
    const pref = localStorage.getItem('finanxis-theme') || 'auto';
    const label = document.getElementById('pref-theme-label');
    label && (label.textContent = pref === 'dark' ? 'Oscuro' : (pref === 'light' ? 'Claro' : 'Auto'));
  })();
</script>
{% endblock %}
