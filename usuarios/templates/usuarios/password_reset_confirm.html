{% extends "base.html" %}
{% block title %}Nueva contraseña — Finanxis{% endblock %}

{% block content %}
<section class="max-w-md mx-auto px-4 py-8">
  <div class="rounded-2xl border border-gray-200 bg-white p-6 shadow-card">
    <h1 class="text-2xl font-extrabold text-gray-900 mb-1">Elegí una nueva contraseña</h1>

    {% if validlink %}
      <form method="post" class="mt-4 space-y-4">
        {% csrf_token %}

        {# Errores del form (si los hay) #}
        {% if form.errors %}
          <div class="rounded-lg border border-rose-200 bg-rose-50 text-rose-900 text-sm px-3 py-2">
            {% for field in form %}
              {% if field.errors %}
                <div><b>{{ field.label }}:</b> {{ field.errors|striptags }}</div>
              {% endif %}
            {% endfor %}
            {% for e in form.non_field_errors %}
              <div>{{ e }}</div>
            {% endfor %}
          </div>
        {% endif %}

        <label class="block">
          <span class="block text-xs text-gray-600 mb-1">Contraseña nueva</span>
          <input
            type="password" name="new_password1" required
            class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary"
            autocomplete="new-password"
          >
        </label>

        <label class="block">
          <span class="block text-xs text-gray-600 mb-1">Confirmar contraseña</span>
          <input
            type="password" name="new_password2" required
            class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary"
            autocomplete="new-password"
          >
        </label>

        <button class="w-full rounded-xl bg-primary text-dark font-semibold px-4 py-2 hover:opacity-90">
          Guardar contraseña
        </button>
      </form>
    {% else %}
      <p class="mt-2 text-sm text-gray-600">
        El enlace no es válido o expiró. Podés solicitar uno nuevo.
      </p>
      <a class="inline-block mt-3 text-sm font-semibold text-primary hover:opacity-90" href="{% url 'password_reset' %}">
        Volver a solicitar
      </a>
    {% endif %}
  </div>
</section>
{% endblock %}
